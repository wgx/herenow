!function(){const s="https://herenow-anhz7w.fly.dev";const t="hereNowSessionId",i=document.querySelectorAll(".herenow");if(0!==i.length){const c=window.location.hostname+window.location.pathname;let a=!0;const o=function(){let e=sessionStorage.getItem(t);return e||(e=crypto.randomUUID(),sessionStorage.setItem(t,e)),e}(),r=document.referrer||"direct";async function e(){try{await fetch(s+"/ping",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sessionId:o,page:c,referrer:r})})}catch(e){console.error("Failed to send ping:",e)}}async function n(){try{var t=encodeURIComponent(c),n=await fetch(s+"/count?page="+t);if(!n.ok)throw new Error("Server responded with status: "+n.status);let e=(await n.json()).count||0;a&&0===e&&(e=1),a=!1;var o=1===e?"user":"users";const r=`<a href="https://wgx.github.io/herenow/" target="_blank" style="color: inherit; text-decoration: none;">${e+` ${o} here now`}</a>`;i.forEach(e=>{e.innerHTML=r})}catch(e){console.error("Failed to fetch count:",e),i.forEach(e=>{e.textContent="Herenow unavailable"})}}e(),n(),setInterval(e,15e3),setInterval(n,15e3),window.addEventListener("beforeunload",function(){var e=JSON.stringify({sessionId:o,page:c,referrer:r}),e=new Blob([e],{type:"application/json"});navigator.sendBeacon(s+"/ping",e)})}}();